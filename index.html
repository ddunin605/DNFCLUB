<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>던파동호회 자기소개표!</title>

<style>
@font-face{
  font-family:'DNFBitBitv2';
  font-style:normal;
  font-weight:400;
  src:url('//cdn.df.nexon.com/img/common/font/DNFBitBitv2.otf') format('opentype');
}
:root{ --stage-w:737px; --stage-h:737px; --txt-size:16px; }

*{box-sizing:border-box}
html,body{margin:0; background:#0b0e12; color:#e9eef5; font-family:'DNFBitBitv2',sans-serif}
.wrap{display:grid; gap:16px; grid-template-columns:320px var(--stage-w); padding:18px; place-content:start center;}
.panel{display:flex; flex-direction:column; gap:12px; background:#131821; border:1px solid #202838; border-radius:12px; padding:14px; box-shadow:0 6px 20px rgba(0,0,0,.35);}
.panel h2{margin:0; font-size:20px}
.row{display:grid; gap:6px}
.grid2{display:grid; grid-template-columns:1fr 1fr; gap:6px}
label{font-size:14px; opacity:.9}
input[type="text"],input[type="file"]{width:100%; padding:8px 10px; border-radius:10px; border:1px solid #2a3348; background:#0f141d; color:#e9eef5; outline:none; font-family:'DNFBitBitv2',sans-serif; font-size:14px;}
button{width:100%; padding:12px; border:0; border-radius:12px; font-weight:700; cursor:pointer; background:#5a7cff; color:#0b0e12;}

.group{border:1px solid #202838; border-radius:10px; padding:8px}
.group h3{margin:0 0 6px; font-size:16px}
.group .cols{display:grid; grid-template-columns:1fr 1fr; gap:6px 10px}
.group label{display:flex; align-items:center; gap:6px; font-size:14px}

.stage{position:relative; width:var(--stage-w); height:var(--stage-h); background:#000; overflow:hidden; border-radius:12px; box-shadow:0 12px 28px rgba(0,0,0,.5); border:1px solid #202838;}
.stage img.layer{position:absolute; inset:0; width:100%; height:100%; object-fit:contain; pointer-events:none;}

.t{
  position:absolute; white-space:pre-wrap; color:#fff; pointer-events:none;
  font-size:var(--txt-size); line-height:1.15;
  text-shadow:0 0 2px rgba(0,0,0,.85),0 0 4px rgba(0,0,0,.85),0 1px 0 rgba(0,0,0,.9),1px 0 0 rgba(0,0,0,.9),-1px 0 0 rgba(0,0,0,.9),0 -1px 0 rgba(0,0,0,.9);
}


#profileBox{
  position:absolute; left:34.9172px; top:144.516px; width:125px; height:125px;
  overflow:hidden; border-radius:12px; pointer-events:none;
}
#profileImg{width:100%; height:100%; object-fit:cover}
</style>
</head>
<body>
<div class="wrap">
  <div class="panel">
    <h2>던파동호회 자기소개표</h2>

    <div class="row">
      <label>프로필 이미지 업로드</label>
      <input id="inProfileFile" type="file" accept="image/*">
    </div>

    <div class="row grid2">
      <div><label>모험단</label><input id="inAdventure" type="text"></div>
      <div><label>서버</label><input id="inServer" type="text"></div>
    </div>
    <div class="row grid2">
      <div><label>닉네임</label><input id="inNickname" type="text"></div>
      <div><label>생일</label><input id="inBirthday" type="text"></div>
    </div>
    <div class="row grid2">
      <div><label>MBTI</label><input id="inMBTI" type="text"></div>
      <div><label>하고싶은 말</label><input id="inMessage" type="text"></div>
    </div>


    <div class="group"><h3>플레이 시간</h3><div class="cols" id="grp-time"></div></div>
    <div class="group"><h3>플레이 성향</h3><div class="cols" id="grp-style"></div></div>
    <div class="group"><h3>오픈카톡</h3><div class="cols" id="grp-open"></div></div>
    <div class="group"><h3>디스코드</h3><div class="cols" id="grp-discord"></div></div>
    <div class="group"><h3>핥아지는거</h3><div class="cols" id="grp-social"></div></div>
    <div class="group"><h3>셋팅 지적</h3><div class="cols" id="grp-judge"></div></div>
    <div class="group"><h3>소통방법</h3><div class="cols" id="grp-comm"></div></div>
    <div class="group"><h3>저는!</h3><div class="cols" id="grp-self"></div></div>
    <div class="group"><h3>직업</h3><div class="cols" id="grp-job"></div></div>

    <button id="btnDownload">PNG로 다운로드</button>
  </div>

  <div id="stage" class="stage">

    <img id="bg" class="layer" alt="배경" src="던파동호회 자기소개표.png">


    <div id="profileBox"><img id="profileImg" alt=""></div>


    <div id="tAdventure" class="t" style="left:233.563px; top:167.43px; width:325.645px;"></div>
    <div id="tServer"    class="t" style="left:216.11px;  top:196.991px; width:325.645px;"></div>
    <div id="tNickname"  class="t" style="left:234px;     top:227px;     width:325.645px;"></div>
    <div id="tBirthday"  class="t" style="left:441px;     top:167.43px;  width:325.645px;"></div>
    <div id="tMBTI"      class="t" style="left:458px;     top:196.991px; width:271.37px;"></div>
    <div id="tMessage"   class="t" style="left:494px;     top:227px;     width:352.782px;"></div>


    <img id="layPlayMorning" class="layer" style="display:none;">
    <img id="layPlayNoon" class="layer" style="display:none;">
    <img id="layPlayEvening" class="layer" style="display:none;">
    <img id="layPlayDawn" class="layer" style="display:none;">
    <img id="layPlayWeekday" class="layer" style="display:none;">
    <img id="layPlayWeekend" class="layer" style="display:none;">
    <img id="layStyleSpecUp" class="layer" style="display:none;">
    <img id="layStyleStory" class="layer" style="display:none;">
    <img id="layStyleCodi" class="layer" style="display:none;">
    <img id="layStyleArena" class="layer" style="display:none;">
    <img id="layStyleWild" class="layer" style="display:none;">
    <img id="layStyleSolo" class="layer" style="display:none;">
    <img id="layStyleFriends" class="layer" style="display:none;">
    <img id="layStyleGuild" class="layer" style="display:none;">
    <img id="layOpenChatTalk" class="layer" style="display:none;">
    <img id="layOpenChatInfo" class="layer" style="display:none;">
    <img id="layOpenChatParty" class="layer" style="display:none;">
    <img id="layOpenChatLurk" class="layer" style="display:none;">
    <img id="layOpenChatTrade" class="layer" style="display:none;">
    <img id="layDiscordYes" class="layer" style="display:none;">
    <img id="layDiscordNo" class="layer" style="display:none;">
    <img id="layMicOn" class="layer" style="display:none;">
    <img id="layListenOnly" class="layer" style="display:none;">
    <img id="layMicOff" class="layer" style="display:none;">
    <img id="laySocialLike" class="layer" style="display:none;">
    <img id="laySocialDislike" class="layer" style="display:none;">
    <img id="laySocialOnlyMe" class="layer" style="display:none;">
    <img id="laySocialDontCare" class="layer" style="display:none;">
    <img id="layJudgeYes" class="layer" style="display:none;">
    <img id="layJudgeNo" class="layer" style="display:none;">
    <img id="layCommStartPlease" class="layer" style="display:none;">
    <img id="layCommJokeOk" class="layer" style="display:none;">
    <img id="laySelfNewbie" class="layer" style="display:none;">
    <img id="laySelfVeteran" class="layer" style="display:none;">
    <img id="laySelfReturn" class="layer" style="display:none;">
    <img id="laySelfFunLover" class="layer" style="display:none;">
    <img id="layJobSlayer" class="layer" style="display:none;">
    <img id="layJobFighter" class="layer" style="display:none;">
    <img id="layJobGunner" class="layer" style="display:none;">
    <img id="layJobMage" class="layer" style="display:none;">
    <img id="layJobPriest" class="layer" style="display:none;">
    <img id="layJobThief" class="layer" style="display:none;">
    <img id="layJobKnight" class="layer" style="display:none;">
    <img id="layJobLancer" class="layer" style="display:none;">
    <img id="layJobAgent" class="layer" style="display:none;">
    <img id="layJobYacha" class="layer" style="display:none;">
    <img id="layJobSide" class="layer" style="display:none;">
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
<script>
const $ = s => document.querySelector(s);


function bindAll(){
  $('#tAdventure').textContent = $('#inAdventure').value || '';
  $('#tServer').textContent    = $('#inServer').value || '';
  $('#tNickname').textContent  = $('#inNickname').value || '';
  $('#tBirthday').textContent  = $('#inBirthday').value || '';
  $('#tMBTI').textContent      = $('#inMBTI').value || '';
  $('#tMessage').textContent   = $('#inMessage').value || '';
}
['#inAdventure','#inServer','#inNickname','#inBirthday','#inMBTI','#inMessage']
  .forEach(id => $(id).addEventListener('input', bindAll));
bindAll();

$('#inProfileFile').addEventListener('change', e=>{
  const f = e.target.files[0]; if(!f) return;
  const r = new FileReader();
  r.onload = ev => $('#profileImg').src = ev.target.result;
  r.readAsDataURL(f);
});


const BASE_PATH = "./"; // 같은 폴더
const GROUPS = {
  time: [
    ['layPlayMorning','21.png','아침'], ['layPlayNoon','22.png','낮'],
    ['layPlayEvening','23.png','저녁'], ['layPlayDawn','24.png','새벽'],
    ['layPlayWeekday','25.png','평일반'], ['layPlayWeekend','26.png','주말반'],
  ],
  style: [
    ['layStyleSpecUp','31.png','스펙업'], ['layStyleStory','32.png','스토리'],
    ['layStyleCodi','33.png','코디'], ['layStyleArena','34.png','결투장'],
    ['layStyleWild','35.png','야생'], ['layStyleSolo','36.png','솔플'],
    ['layStyleFriends','37.png','지인팟'], ['layStyleGuild','38.png','길드팟'],
  ],
  open: [
    ['layOpenChatTalk','41.png','수다'], ['layOpenChatInfo','42.png','정보공유'],
    ['layOpenChatParty','43.png','파티모집'], ['layOpenChatLurk','44.png','눈팅'],
    ['layOpenChatTrade','45.png','거래'],
  ],
  discord: [
    ['layDiscordYes','51.png','디스코드 가능'], ['layDiscordNo','52.png','불가능'],
    ['layMicOn','53.png','마이크 O'], ['layListenOnly','54.png','듣기만'],
    ['layMicOff','55.png','마이크 X'],
  ],
  social: [
    ['laySocialLike','61.png','좋다'], ['laySocialDislike','62.png','싫다'],
    ['laySocialOnlyMe','63.png','나만 할줄안다'], ['laySocialDontCare','64.png','상관없음'],
  ],
  judge: [['layJudgeYes','71.png','좋아요'], ['layJudgeNo','72.png','싫어요']],
  comm:  [['layCommStartPlease','81.png','먼저 말 걸어주세요'], ['layCommJokeOk','82.png','장난치셔도 돼요']],
  self:  [['laySelfNewbie','91.png','뉴비'], ['laySelfVeteran','92.png','고인물'], ['laySelfReturn','93.png','복귀'], ['laySelfFunLover','94.png','븜미좋아']],
  job:   [
    ['layJobSlayer','101.png','귀검사'], ['layJobFighter','102.png','격투가'],
    ['layJobGunner','103.png','거너'], ['layJobMage','104.png','마법사'],
    ['layJobPriest','105.png','프리스트'], ['layJobThief','106.png','도적'],
    ['layJobKnight','107.png','나이트'], ['layJobLancer','108.png','마창사'],
    ['layJobAgent','109.png','총검사'], ['layJobYacha','110.png','아처'],
    ['layJobSide','111.png','외전'],
  ],
};

function makeGroup(mountId, items){
  const holder = document.getElementById('grp-'+mountId);
  items.forEach(([layerId, file, label])=>{
    const lbl = document.createElement('label');
    const input = document.createElement('input');
    input.type = 'checkbox'; input.dataset.layer = layerId; input.dataset.file = file;
    lbl.appendChild(input); lbl.append(' '+label);
    holder.appendChild(lbl);
  });
}
Object.entries(GROUPS).forEach(([k, arr])=> makeGroup(k, arr));


document.querySelectorAll('.group .cols').forEach(box=>{
  box.addEventListener('change', e=>{
    const t = e.target;
    if(!t.matches('input[type=checkbox][data-layer]')) return;
    const img = document.getElementById(t.dataset.layer);
    if(t.checked){
      if(!img.src || img.src.endsWith('#')) img.src = BASE_PATH + t.dataset.file;
      img.style.display = 'block';
    }else{
      img.style.display = 'none';
    }
  });
});


document.getElementById('btnDownload').addEventListener('click', async ()=>{
  await document.fonts.ready;
  const stage = document.getElementById('stage');
  await Promise.all([...stage.querySelectorAll('img')].map(img=>{
    if(!img.src) return Promise.resolve();
    if(img.complete) return Promise.resolve();
    return new Promise(res=>{ img.onload = img.onerror = res; });
  }));
  const canvas = await html2canvas(stage, { backgroundColor:null, scale:3 });
  const a=document.createElement('a');
  a.download='던파동호회_자기소개표.png';
  a.href=canvas.toDataURL('image/png');
  a.click();
});
</script>
</body>
</html>



